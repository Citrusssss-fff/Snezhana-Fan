async function tai__init(e,t,i,a,n,o){const s=window.location.search.includes("aimin=n"),c=undefined,r=`https://tilda.${2===window.location.hostname.split(".").pop().length?window.location.hostname.split(".").pop():"cc"}/front/tildaai`,d="https://front.tildacdn.com/tildaai",l=["t-ai.min.css"],p=["t-ai-common.min.js","t-ai-dict.min.js","t-ai-draw.min.js"];switch(e){case"quick":p.push("t-ai-field-quick-actions.min.js"),p.push("t-ai-field-gen.min.js");break;case"field":p.push("t-ai-field-gen.min.js");break;case"block":p.push("t-ai-block-gen.min.js"),p.push("t-ai-block-helpers.min.js"),p.push("t-ai-image-match.min.js");break;case"image":p.push("t-ai-img-gen.min.js");break;case"page":case"fullpage":p.push("t-ai-page-gen.min.js"),p.push("t-ai-block-helpers.min.js");break;case"structure":p.push("t-ai-structure-gen.min.js");break;case"feedback":case"page-suggest":p.push("t-ai-page-gen.min.js");break;case"image-match":p.push("t-ai-image-match.min.js"),p.push("t-ai-block-helpers.min.js");break;default:console.error("Error: wrong generation type")}"function"==typeof showLoadIcon&&showLoadIcon();for(let m=0;m<l.length;m++){const e=s?l[m].replace(".min",""):l[m];tai__loadResource(`${s?d:r}/css/${e}`)}await Promise.all(p.map((e=>{const t=s?e.replace(".min",""):e;return tai__loadResource(`${s?d:r}/js/${t}`)}))),"function"==typeof hideLoadIcon&&hideLoadIcon();const u=undefined;switch("99"===(window.userplan||window.$uplan)&&(window.t_ai_tone_enabled=!0),e){case"quick":taiq__init(t,a,i,n,o);break;case"field":taif__init(t,a,i);break;case"block":taib__init(t,i);break;case"image":taii__init(t,i);break;case"page":taip__init(t,"page",i);break;case"fullpage":taip__init(t,"fullpage",i);break;case"structure":tais__init();break;case"feedback":taip__init__feedback(JSON.parse(taip__getFeebackSession()).type);break;case"page-suggest":taip__init__suggest();break;case"image-match":taiim__init(t,i);break;default:console.error("Error: wrong generation type")}tai__initTooltip()}function tai__loadResource(e){const t=e.split(".").pop(),i=undefined,a=e+(window.ver?"?v="+window.ver:"");return"css"===t?tai__loadFile(a,"style"):"js"===t?tai__loadFile(a,"script"):Promise.reject("Unknown resource extension. Make sure the resource url ends with .css or .js")}function tai__loadFile(e,t){return new Promise(((i,a)=>{const n="style"===t,o=n?"link":"script",s=n?"href":"src";let c;try{const{pathname:t,origin:i,href:a}=new URL(e,window.location.href);c=a.includes("tilda")?t:i+t}catch(l){c=e,console.log(l)}const r=document.querySelector(`${o}[${s}*="${c}"]`);if(r)return"true"===r.getAttribute("data-loading")?(r.addEventListener("load",i),void r.addEventListener("error",a)):i();const d=document.createElement(o);d.setAttribute(s,e),n&&d.setAttribute("rel","stylesheet"),d.setAttribute("data-loading","true"),d.addEventListener("load",(()=>(d.removeAttribute("data-loading"),i()))),d.addEventListener("error",(()=>(document.head.removeChild(d),a()))),document.head.appendChild(d)}))}async function tai__initTooltip(){const e=["https://static.tildacdn.com/css/tooltipster.min.css","https://static.tildacdn.com/js/tilda-tooltip-1.0.min.js"];"function"!=typeof window.tooltipster&&await Promise.all(e.map((e=>tai__loadResource(e))));const t=["js-regenerate","js-actions-regenerate","js-show-history","tai_head__help","js-head-compress","js-head-compress"];let i=document.querySelectorAll("#tai-popup .tai_tooltip");const a=undefined;matchMedia("(pointer: coarse)").matches&&(i=Array.from(i).filter((e=>!t.some((t=>e.classList.contains(t)))))),i.forEach((e=>{const t=e.getAttribute("data-position")||"top";window.tooltipster([e],{position:t,delay:300,theme:"tai_tooltip_noir",contentAsHTML:!0,minWidth:50,maxWidth:300})}))}function tai__checkFeedbackSession(){const e=undefined;sessionStorage.getItem(`t-ai-feedback-${window.projectid}-${window.pageid}`)&&tai__init("feedback")}function tai__checkPageGetParametres(){const e=window.location.search.indexOf("new=y")>-1;if(!e)return;const t=window.location.search.indexOf("gen=y")>-1;if(e&&t){let e=window.localStorage.getItem("t-ai-page-data"+window.pageid);return e=e&&JSON.parse(e),void(e&&e.blocks&&e.blocks.length>0&&tai__init("fullpage"))}const i=tp__record__getAllRecordElements();if(0===i.length)return void localStorage.setItem("first-generate-page-"+window.pageid,"y");const a=window.location.search.split("type=")[1];e&&i.length>0&&a&&["st","cp","ed","fr","zb","em"].indexOf(a)<0&&setTimeout((function(){tai__init("page-suggest")}),2e3)}tai__checkFeedbackSession(),tai__checkPageGetParametres();
